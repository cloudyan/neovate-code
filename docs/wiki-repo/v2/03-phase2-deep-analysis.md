# é˜¶æ®µ2: æ·±åº¦æ¨¡å—æŒ–æ˜

> **æ—¶é•¿**: 30-40åˆ†é’Ÿ  
> **ç›®æ ‡**: å¯¹æ ¸å¿ƒæ¨¡å—è¿›è¡Œæ·±åº¦åˆ†æ,æå–æ¶æ„è®¾è®¡å’Œå…³é”®æµç¨‹  
> **è¾“å…¥**: é˜¶æ®µ1çš„æ¨¡å—ä¼˜å…ˆçº§åˆ—è¡¨  
> **è¾“å‡º**: æ·±åº¦åˆ†ææŠ¥å‘Šã€æ•°æ®æµå›¾ã€æ¶æ„å›¾

---

## ğŸ¯ ç›®æ ‡

å¯¹é«˜ä¼˜å…ˆçº§æ ¸å¿ƒæ¨¡å—è¿›è¡Œæ·±åº¦æŠ€æœ¯åˆ†æ,æå–:
- æ¨¡å—èŒè´£å’Œè®¾è®¡åŸç†
- æ•°æ®æµè½¬å’Œè°ƒç”¨å…³ç³»  
- æ¶æ„æ¨¡å¼å’Œè®¾è®¡æ€æƒ³
- å…³é”®ä¸šåŠ¡æµç¨‹å’ŒæŠ€æœ¯å®ç°

ç¡®ä¿ç”Ÿæˆçš„æ–‡æ¡£åŒ…å«è¯¦ç»†çš„æ¶æ„å›¾ã€æµç¨‹å›¾å’Œæ¨¡å—ä»‹ç»ï¼Œæ»¡è¶³é«˜è´¨é‡wikiæ–‡æ¡£åº“çš„è¦æ±‚ã€‚

---

## ğŸ“‹ æ‰§è¡Œæ­¥éª¤

### Step 2.1: æ ¸å¿ƒæ¨¡å—ä»£ç åˆ†æ

é’ˆå¯¹æ¯ä¸ªé«˜ä¼˜å…ˆçº§æ¨¡å—æ‰§è¡Œæ·±åº¦åˆ†æ:

#### åˆ†ææ£€æŸ¥æ¸…å•

```markdown
âœ… ç±»/å‡½æ•°èŒè´£è¯†åˆ«
- [ ] å¯¼å‡ºçš„ç±»/å‡½æ•°åˆ—è¡¨
- [ ] æ¯ä¸ªç±»çš„èŒè´£ (å•ä¸€èŒè´£åŸåˆ™éªŒè¯)
- [ ] å…¬å¼€API vs å†…éƒ¨å®ç°
- [ ] æ¥å£è®¾è®¡å’ŒæŠ½è±¡å±‚æ¬¡

âœ… ä¾èµ–å…³ç³»åˆ†æ  
- [ ] ä¾èµ–äº†å“ªäº›æ¨¡å— (importè¯­å¥åˆ†æ)
- [ ] è¢«å“ªäº›æ¨¡å—ä¾èµ– (åå‘å¼•ç”¨æœç´¢)
- [ ] å¾ªç¯ä¾èµ–æ£€æµ‹
- [ ] ä¾èµ–å…³ç³»å¯è§†åŒ–

âœ… è®¾è®¡æ¨¡å¼è¯†åˆ«
- [ ] ä½¿ç”¨çš„è®¾è®¡æ¨¡å¼ (å•ä¾‹/å·¥å‚/è§‚å¯Ÿè€…/ç­–ç•¥/è£…é¥°å™¨ç­‰)
- [ ] ä¸ºä»€ä¹ˆä½¿ç”¨è¯¥æ¨¡å¼
- [ ] æ¨¡å¼å®ç°çš„å…³é”®ä»£ç 
- [ ] æ¨¡å¼å¸¦æ¥çš„ä¼˜åŠ¿å’Œä»£ä»·

âœ… æ ¸å¿ƒæµç¨‹æå–
- [ ] ä¸»è¦æ–¹æ³•çš„æ‰§è¡Œæµç¨‹
- [ ] å¼‚æ­¥è°ƒç”¨é“¾å’ŒPromiseé“¾
- [ ] é”™è¯¯å¤„ç†æœºåˆ¶å’Œå¼‚å¸¸è¾¹ç•Œ
- [ ] æ€§èƒ½å…³é”®è·¯å¾„åˆ†æ
```

#### ä»£ç åˆ†æè„šæœ¬

```bash
# åˆ†ææ¨¡å—å¯¼å‡º
function analyze_exports() {
  local file=$1
  echo "## å¯¼å‡ºåˆ†æ: $(basename $file)"
  
  # æå–å¯¼å‡ºå£°æ˜
  grep -n "^export" "$file" | while read line; do
    echo "- $line"
  done
  
  # æå–ç±»å®šä¹‰
  grep -n "^class\|^interface\|^type\|^enum" "$file" | while read line; do
    echo "- $line"
  done
}

# åˆ†æä¾èµ–å…³ç³»
function analyze_dependencies() {
  local file=$1
  echo "## ä¾èµ–åˆ†æ: $(basename $file)"
  
  # æå– import è¯­å¥
  grep -n "^import\|^from" "$file" | sed 's/.*import\|from//' | \
    sed "s/'//g; s/\"//g; s/.*\///; s/;//" | sort | uniq | while read dep; do
    echo "- ä¾èµ–: $dep"
  done
  
  # åå‘æœç´¢è°ä¾èµ–äº†è¿™ä¸ªæ–‡ä»¶
  module_name=$(basename "$file" .ts)
  references=$(grep -r "import.*$module_name\|from.*$module_name" src/ | wc -l)
  echo "- è¢«å¼•ç”¨æ¬¡æ•°: $references"
}
```

### Step 2.2: æ•°æ®æµè¿½è¸ª

#### æ•°æ®æµåˆ†ææ–¹æ³•

```markdown
ç›®æ ‡: è¿½è¸ªå…³é”®æ•°æ®åœ¨ç³»ç»Ÿä¸­çš„å®Œæ•´æµè½¬è·¯å¾„

è¿½è¸ªæ–¹æ³•:
1. **è¯†åˆ«æ ¸å¿ƒæ•°æ®ç»“æ„** - æŸ¥æ‰¾ interface/type å®šä¹‰
2. **è¿½è¸ªæ•°æ®åˆ›å»ºç‚¹** - æ„é€ å‡½æ•°ã€å·¥å‚æ–¹æ³•ã€APIå“åº”
3. **è¿½è¸ªæ•°æ®è½¬æ¢ç‚¹** - mappingã€transformã€æ•°æ®å¤„ç†å‡½æ•°  
4. **è¿½è¸ªæ•°æ®æ¶ˆè´¹ç‚¹** - æ¸²æŸ“ã€å­˜å‚¨ã€è¾“å‡ºã€ç½‘ç»œè¯·æ±‚

è¾“å‡ºè¦æ±‚:
- Mermaid Sequence Diagram åºåˆ—å›¾
- æ•°æ®çŠ¶æ€å˜åŒ–è¯´æ˜
- å…³é”®è½¬æ¢é€»è¾‘æ ‡æ³¨
```

#### æ•°æ®æµè¿½è¸ªè„šæœ¬

```bash
# è¿½è¸ªç‰¹å®šç±»å‹çš„æ•°æ®æµ
function track_data_flow() {
  local data_type=$1
  local start_file=$2
  
  echo "è¿½è¸ªæ•°æ®ç±»å‹: $data_type"
  echo "èµ·å§‹æ–‡ä»¶: $start_file"
  
  # æŸ¥æ‰¾æ•°æ®å®šä¹‰
  grep -rn "interface.*$data_type\|type.*$data_type" src/ | head -5
  
  # æŸ¥æ‰¾åˆ›å»ºç‚¹
  echo "## æ•°æ®åˆ›å»ºç‚¹"
  grep -rn "new.*$data_type\|$data_type.*=\|create$data_type" src/ | head -5
  
  # æŸ¥æ‰¾ä½¿ç”¨ç‚¹
  echo "## æ•°æ®ä½¿ç”¨ç‚¹"
  grep -rn "$data_type" src/ | grep -v "interface\|type" | head -10
}

# ç¤ºä¾‹: è¿½è¸ªç”¨æˆ·æ•°æ®æµ
track_data_flow "User" "src/types/user.ts"
```

### Step 2.3: æ¶æ„æ¨¡å¼æå–

#### æ¶æ„åˆ†æé—®é¢˜æ¸…å•

```markdown
1. **åˆ†å±‚æ¶æ„åˆ†æ**
   - æ˜¯å¦æœ‰æ˜ç¡®çš„åˆ†å±‚? (UI/ä¸šåŠ¡/æ•°æ®/åŸºç¡€è®¾æ–½)
   - å„å±‚èŒè´£è¾¹ç•Œæ˜¯å¦æ¸…æ™°?
   - å±‚é—´é€šä¿¡æœºåˆ¶æ˜¯ä»€ä¹ˆ? (äº‹ä»¶ã€å›è°ƒã€æ¶ˆæ¯é˜Ÿåˆ—)
   - æ˜¯å¦å­˜åœ¨å±‚é—´è¶Šæƒè°ƒç”¨?

2. **æ¨¡å—åŒ–è®¾è®¡åˆ†æ**
   - æ¨¡å—åˆ’åˆ†åŸåˆ™æ˜¯ä»€ä¹ˆ? (åŠŸèƒ½ã€é¢†åŸŸã€æŠ€æœ¯)
   - æ¨¡å—é—´è€¦åˆåº¦å¦‚ä½•? (é«˜å†…èšä½è€¦åˆè¯„ä¼°)
   - æ˜¯å¦æ”¯æŒæ’ä»¶åŒ–æˆ–å¯æ‰©å±•?
   - æ¨¡å—æ¥å£è®¾è®¡æ˜¯å¦ç¨³å®š?

3. **å…³é”®æŠ½è±¡åˆ†æ**
   - æ ¸å¿ƒæ¥å£/æŠ½è±¡ç±»æœ‰å“ªäº›?
   - æŠ½è±¡çš„ç›®çš„æ˜¯ä»€ä¹ˆ? (è§£è€¦ã€æ‰©å±•ã€æµ‹è¯•)
   - å®ç°ç±»æœ‰å“ªäº›? æ˜¯å¦ç¬¦åˆé‡Œæ°æ›¿æ¢åŸåˆ™?
   - æŠ½è±¡å±‚æ¬¡æ˜¯å¦åˆç†?

4. **è®¾è®¡åŸåˆ™éªŒè¯**
   - å•ä¸€èŒè´£åŸåˆ™ (SRP) ç¬¦åˆåº¦
   - å¼€é—­åŸåˆ™ (OCP) ç¬¦åˆåº¦  
   - ä¾èµ–å€’ç½®åŸåˆ™ (DIP) ç¬¦åˆåº¦
   - æ¥å£éš”ç¦»åŸåˆ™ (ISP) ç¬¦åˆåº¦
```

#### æ¶æ„å›¾ç”Ÿæˆ

```mermaid
graph TD
    A[HTTP Request] --> B[Controller Layer]
    B --> C[Service Layer]
    C --> D[Repository Layer]
    D --> E[Database]
    
    B -.-> F[DTO Validation]
    C -.-> G[Business Logic]
    D -.-> H[Data Access]
    
    style A fill:#ff6b6b,color:#fff
    style B fill:#4ecdc4,color:#fff
    style C fill:#45b7d1,color:#fff
    style D fill:#96ceb4,color:#fff
```

### Step 2.4: å…³é”®æµç¨‹å›¾ç”Ÿæˆ

#### å¿…é¡»ç”Ÿæˆæµç¨‹å›¾çš„åœºæ™¯

```markdown
1. **ç”¨æˆ·æ“ä½œæµç¨‹** (ç”¨æˆ·è§†è§’)
   - ç”¨æˆ·è¾“å…¥ â†’ ç³»ç»Ÿå¤„ç† â†’ è¾“å‡ºç»“æœ
   - æ¶‰åŠ: è¡¨å•æäº¤ã€æŒ‰é’®ç‚¹å‡»ã€å¯¼èˆªè·³è½¬
   
2. **æ ¸å¿ƒä¸šåŠ¡æµç¨‹** (ä¸šåŠ¡è§†è§’)  
   - è®¢å•åˆ›å»º â†’ æ”¯ä»˜ â†’ å‘è´§ â†’ å®Œæˆ
   - æ¶‰åŠ: çŠ¶æ€æœºè½¬æ¢ã€ä¸šåŠ¡è§„åˆ™éªŒè¯
   
3. **æŠ€æœ¯å®ç°æµç¨‹** (æŠ€æœ¯è§†è§’)
   - è¯·æ±‚æ¥æ”¶ â†’ è·¯ç”±åˆ†å‘ â†’ ä¸šåŠ¡å¤„ç† â†’ å“åº”è¿”å›
   - æ¶‰åŠ: ä¸­é—´ä»¶é“¾ã€é”™è¯¯å¤„ç†ã€å¼‚æ­¥æ“ä½œ

4. **æ•°æ®æµè½¬æµç¨‹** (æ•°æ®è§†è§’)
   - æ•°æ®åˆ›å»º â†’ è½¬æ¢å¤„ç† â†’ å­˜å‚¨æ¶ˆè´¹
   - æ¶‰åŠ: æ•°æ®æ ¼å¼è½¬æ¢ã€éªŒè¯æ¸…æ´—
```

#### æµç¨‹å›¾ç±»å‹é€‰æ‹©æŒ‡å—

```markdown
- **ç®€å•çº¿æ€§æµç¨‹**: Mermaid Flowchart (æµç¨‹å›¾)
- **å¤æ‚äº¤äº’æµç¨‹**: Mermaid Sequence Diagram (åºåˆ—å›¾)  
- **çŠ¶æ€è½¬æ¢æµç¨‹**: Mermaid State Diagram (çŠ¶æ€å›¾)
- **å†³ç­–åˆ†æ”¯æµç¨‹**: Mermaid Flowchart with conditionals
- **å¹¶è¡Œå¤„ç†æµç¨‹**: Mermaid Flowchart with parallel paths
```

#### åºåˆ—å›¾ç¤ºä¾‹

```mermaid
sequenceDiagram
    participant User
    participant Frontend
    participant Backend
    participant Database
    
    User->>Frontend: æäº¤è¡¨å•
    Frontend->>Backend: POST /api/data
    Backend->>Database: æŸ¥è¯¢éªŒè¯
    Database-->>Backend: è¿”å›ç»“æœ
    Backend->>Backend: ä¸šåŠ¡å¤„ç†
    Backend-->>Frontend: è¿”å›å“åº”
    Frontend-->>User: æ˜¾ç¤ºç»“æœ
```

---

## ğŸ“Š è¾“å‡ºäº§ç‰©

```
wikirepo/analysis/
â”œâ”€â”€ core-modules/
â”‚   â”œâ”€â”€ loop-analysis.md           # Loopæ¨¡å—æ·±åº¦åˆ†æ
â”‚   â”œâ”€â”€ context-analysis.md        # Contextæ¨¡å—æ·±åº¦åˆ†æ
â”‚   â””â”€â”€ project-analysis.md         # Projectæ¨¡å—æ·±åº¦åˆ†æ
â”œâ”€â”€ data-flow-diagrams/
â”‚   â”œâ”€â”€ user-data-flow.mmd         # ç”¨æˆ·æ•°æ®æµè½¬
â”‚   â”œâ”€â”€ message-flow.mmd           # æ¶ˆæ¯æµè½¬
â”‚   â””â”€â”€ tool-execution-flow.mmd    # å·¥å…·æ‰§è¡Œæµç¨‹
â”œâ”€â”€ architecture-patterns.md        # æ¶æ„æ¨¡å¼æ€»ç»“
â””â”€â”€ design-decisions.md            # è®¾è®¡å†³ç­–è®°å½•
```

### 1. æ ¸å¿ƒæ¨¡å—æ·±åº¦åˆ†ææŠ¥å‘Š

**æ–‡ä»¶æ ¼å¼**: `core-modules/[æ¨¡å—å]-analysis.md`

```markdown
# Loop æ¨¡å—æ·±åº¦åˆ†æ

> æºç ä½ç½®: `src/loop.ts:1-450`  
> ä¼˜å…ˆçº§: â­â­â­â­â­ (æƒé‡: 45)  
> åˆ†æè€—æ—¶: 8.2 åˆ†é’Ÿ

## ğŸ“‹ æ¨¡å—æ¦‚è§ˆ

### æ ¸å¿ƒèŒè´£
1. **AI ä»»åŠ¡è°ƒåº¦** - ç®¡ç†AIä»»åŠ¡çš„æ‰§è¡Œé˜Ÿåˆ—å’Œä¼˜å…ˆçº§
2. **çŠ¶æ€ç®¡ç†** - ç»´æŠ¤ä¼šè¯çŠ¶æ€å’Œæ‰§è¡Œä¸Šä¸‹æ–‡  
3. **é”™è¯¯å¤„ç†** - æ•è·å’Œå¤„ç†æ‰§è¡Œè¿‡ç¨‹ä¸­çš„å¼‚å¸¸
4. **æ€§èƒ½ç›‘æ§** - è·Ÿè¸ªä»»åŠ¡æ‰§è¡Œæ—¶é—´å’Œèµ„æºä½¿ç”¨

### æŠ€æœ¯æŒ‡æ ‡
- **ä»£ç è¡Œæ•°**: 450 LOC
- **å¯¼å‡ºå‡½æ•°**: 5 ä¸ª
- **ä¾èµ–æ¨¡å—**: 8 ä¸ª
- **è¢«å¼•ç”¨æ¬¡æ•°**: 15 æ¬¡

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### è®¾è®¡æ¨¡å¼
- **è§‚å¯Ÿè€…æ¨¡å¼** - ç”¨äºçŠ¶æ€å˜æ›´é€šçŸ¥
- **ç­–ç•¥æ¨¡å¼** - ä¸åŒçš„ä»»åŠ¡æ‰§è¡Œç­–ç•¥
- **å·¥å‚æ¨¡å¼** - åˆ›å»ºä¸åŒç±»å‹çš„ä»»åŠ¡å¤„ç†å™¨

### ä¾èµ–å…³ç³»
```mermaid
graph LR
    A[loop.ts] --> B[context.ts]
    A --> C[project.ts]
    A --> D[tools/index.ts]
    A --> E[utils/logger.ts]
    A --> F[types/index.ts]
    
    style A fill:#ff6b6b,color:#fff
```

## ğŸ”„ æ ¸å¿ƒæµç¨‹

### ä¸»æ‰§è¡Œæµç¨‹

```mermaid
sequenceDiagram
    participant User
    participant Loop
    participant Context
    participant Tools
    
    User->>Loop: æ‰§è¡Œä»»åŠ¡
    Loop->>Context: è·å–ä¸Šä¸‹æ–‡
    Context-->>Loop: è¿”å›ä¸Šä¸‹æ–‡æ•°æ®
    Loop->>Tools: è°ƒç”¨å·¥å…·
    Tools-->>Loop: è¿”å›å·¥å…·ç»“æœ
    Loop->>Loop: å¤„ç†ç»“æœ
    Loop-->>User: è¿”å›æœ€ç»ˆå“åº”
```

### å…³é”®ä»£ç è§£æ

#### 1. `executeTask()` å‡½æ•°
**ä½ç½®**: `src/loop.ts:150-200`

```typescript
async function executeTask(task: Task, context: Context): Promise<Result> {
  try {
    // 1. éªŒè¯ä»»åŠ¡å‚æ•°
    validateTask(task);
    
    // 2. å‡†å¤‡æ‰§è¡Œä¸Šä¸‹æ–‡
    const executionContext = prepareContext(context, task);
    
    // 3. æ‰§è¡Œä»»åŠ¡é€»è¾‘
    const result = await runTaskLogic(task, executionContext);
    
    // 4. å¤„ç†æ‰§è¡Œç»“æœ
    return processResult(result);
  } catch (error) {
    // 5. é”™è¯¯å¤„ç†å’Œæ¢å¤
    return handleError(error, task, context);
  }
}
```

**è®¾è®¡è¦ç‚¹**:
1. å®Œæ•´çš„é”™è¯¯å¤„ç†é“¾æ¡
2. ä¸Šä¸‹æ–‡éš”ç¦»è®¾è®¡
3. å¼‚æ­¥ä»»åŠ¡ç®¡ç†
4. èµ„æºæ¸…ç†æœºåˆ¶

## ğŸ¯ æ€§èƒ½è€ƒè™‘

### å†…å­˜ç®¡ç†
- ä½¿ç”¨ WeakMap å­˜å‚¨ä¸´æ—¶ä¸Šä¸‹æ–‡
- åŠæ—¶é‡Šæ”¾ä¸å†ä½¿ç”¨çš„å¼•ç”¨
- é¿å…å†…å­˜æ³„æ¼æ¨¡å¼

### æ‰§è¡Œæ•ˆç‡
- æ‰¹é‡å¤„ç†ç±»ä¼¼ä»»åŠ¡
- ä½¿ç”¨ç¼“å­˜å‡å°‘é‡å¤è®¡ç®—
- ä¼˜åŒ–å…³é”®è·¯å¾„æ‰§è¡Œæ—¶é—´

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€ç”¨æ³•

```typescript
import { executeTask } from './loop';
import { createTask } from './types';

const task = createTask({
  type: 'analysis',
  input: 'éœ€è¦åˆ†æçš„ä»£ç ',
  options: { depth: 'deep' }
});

const result = await executeTask(task, currentContext);
```

### é«˜çº§ç”¨æ³•

```typescript
// è‡ªå®šä¹‰ä»»åŠ¡å¤„ç†å™¨
Loop.registerHandler('custom-task', async (task, context) => {
  // è‡ªå®šä¹‰å¤„ç†é€»è¾‘
  return { success: true, data: processedData };
});
```

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: ä»»åŠ¡æ‰§è¡Œè¶…æ—¶æ€ä¹ˆåŠ?
A: ç³»ç»Ÿå†…ç½®è¶…æ—¶æœºåˆ¶ï¼Œé»˜è®¤30ç§’è¶…æ—¶ï¼Œå¯é€šè¿‡é…ç½®è°ƒæ•´ã€‚

### Q2: å¦‚ä½•ç›‘æ§ä»»åŠ¡æ‰§è¡ŒçŠ¶æ€?
A: ä½¿ç”¨ `Loop.getTaskStatus(taskId)` æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€ã€‚

### Q3: æ”¯æŒå¹¶å‘æ‰§è¡Œå—?
A: æ”¯æŒæœ‰é™å¹¶å‘ï¼Œé»˜è®¤æœ€å¤§å¹¶å‘æ•°ä¸º5ï¼Œå¯é…ç½®ã€‚

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [æ¶æ„æ€»è§ˆ](../architecture/overview.md)
- [Context æ¨¡å—åˆ†æ](./context-analysis.md)
- [æ•°æ®æµè½¬å›¾](../data-flow-diagrams/task-flow.mmd)
```

### 2. æ•°æ®æµå›¾æ–‡ä»¶

**æ–‡ä»¶æ ¼å¼**: `data-flow-diagrams/[æ•°æ®æµåç§°].mmd`

```mermaid
flowchart TD
    A[ç”¨æˆ·è¾“å…¥] --> B[å‚æ•°éªŒè¯]
    B --> C{éªŒè¯é€šè¿‡?}
    C -->|æ˜¯| D[ä¸šåŠ¡å¤„ç†]
    C -->|å¦| E[è¿”å›é”™è¯¯]
    D --> F[æ•°æ®æŒä¹…åŒ–]
    F --> G[è¿”å›æˆåŠŸ]
    
    style A fill:#ff6b6b,color:#fff
    style G fill:#96ceb4,color:#fff
```

### 3. æ¶æ„æ¨¡å¼æ€»ç»“

**æ–‡ä»¶æ ¼å¼**: `architecture-patterns.md`

```markdown
# æ¶æ„æ¨¡å¼æ€»ç»“

## ğŸ—ï¸ æ•´ä½“æ¶æ„

### åˆ†å±‚æ¶æ„
é¡¹ç›®é‡‡ç”¨æ¸…æ™°çš„ä¸‰å±‚æ¶æ„:

| å±‚çº§ | èŒè´£ | æ ¸å¿ƒæ¨¡å— |
|------|------|----------|
| è¡¨ç°å±‚ | å¤„ç†HTTPè¯·æ±‚,å‚æ•°éªŒè¯ | controllers/
| ä¸šåŠ¡å±‚ | ä¸šåŠ¡é€»è¾‘,é¢†åŸŸæ¨¡å‹ | services/
| æ•°æ®å±‚ | æ•°æ®è®¿é—®,æŒä¹…åŒ– | repositories/

### æ¨¡å—åŒ–è®¾è®¡
- **æŒ‰åŠŸèƒ½åˆ’åˆ†** - æ¯ä¸ªåŠŸèƒ½æ¨¡å—ç‹¬ç«‹
- **æ¥å£é©±åŠ¨** - å®šä¹‰æ¸…æ™°çš„æ¨¡å—æ¥å£
- **ä¾èµ–æ³¨å…¥** - ä½¿ç”¨DIå®¹å™¨ç®¡ç†ä¾èµ–

## ğŸ¯ è®¾è®¡æ¨¡å¼åº”ç”¨

### 1. è§‚å¯Ÿè€…æ¨¡å¼
**åº”ç”¨åœºæ™¯**: çŠ¶æ€å˜æ›´é€šçŸ¥
**å®ç°æ¨¡å—**: `src/observer.ts`
**ä¼˜åŠ¿**: è§£è€¦çŠ¶æ€ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…

### 2. ç­–ç•¥æ¨¡å¼  
**åº”ç”¨åœºæ™¯**: ä¸åŒçš„ä»»åŠ¡æ‰§è¡Œç­–ç•¥
**å®ç°æ¨¡å—**: `src/strategies/`
**ä¼˜åŠ¿**: æ˜“äºæ‰©å±•æ–°çš„æ‰§è¡Œç­–ç•¥

### 3. å·¥å‚æ¨¡å¼
**åº”ç”¨åœºæ™¯**: åˆ›å»ºä¸åŒç±»å‹çš„å¤„ç†å™¨
**å®ç°æ¨¡å—**: `src/factories/`
**ä¼˜åŠ¿**: å°è£…å¯¹è±¡åˆ›å»ºé€»è¾‘
```

---

## ğŸ”§ åˆ†æå·¥å…·å’ŒæŠ€æœ¯

### AST åˆ†æå·¥å…·

```bash
# ä½¿ç”¨ ts-morph è¿›è¡ŒASTåˆ†æ
import { Project } from "ts-morph";

const project = new Project();
const sourceFile = project.addSourceFileAtPath("src/loop.ts");

// åˆ†æç±»ç»“æ„
sourceFile.getClasses().forEach(cls => {
  console.log(`ç±»: ${cls.getName()}`);
  console.log(`æ–¹æ³•æ•°: ${cls.getMethods().length}`);
});
```

### ä¾èµ–åˆ†æå·¥å…·

```bash
# ä½¿ç”¨ madge ç”Ÿæˆä¾èµ–å›¾
npx madge --extensions ts,tsx --image architecture-graph.svg src/

# ä½¿ç”¨ dependency-cruiser éªŒè¯æ¶æ„
npx dependency-cruiser --validate .dependency-cruiser.json src/
```

---

## ğŸ¯ è´¨é‡è¦æ±‚

- **åˆ†ææ·±åº¦**: è¦†ç›–æ‰€æœ‰æ ¸å¿ƒæ¨¡å—çš„90%+ä»£ç 
- **å‡†ç¡®æ€§**: ä»£ç å¼•ç”¨å‡†ç¡®åˆ°å…·ä½“è¡Œå·
- **å®Œæ•´æ€§**: åŒ…å«æ‰€æœ‰é‡è¦æµç¨‹å’Œæ¶æ„æ¨¡å¼
- **å¯è¯»æ€§**: å›¾è¡¨æ¸…æ™°ï¼Œè¯´æ˜è¯¦ç»†
- **å®ç”¨æ€§**: èƒ½ä¸ºå¼€å‘å’Œç»´æŠ¤æä¾›å®é™…ä»·å€¼

---

**ä¸‹ä¸€é˜¶æ®µ**: [é˜¶æ®µ3: ç»“æ„åŒ–æ–‡æ¡£ç”Ÿæˆ](../04-phase3-documentation-generation.md)