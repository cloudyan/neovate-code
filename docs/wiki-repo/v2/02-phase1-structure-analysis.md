# é˜¶æ®µ1: æ™ºèƒ½ç»“æ„åˆ†æ

> **æ³¨æ„**: é˜¶æ®µ1 åœ¨é˜¶æ®µ0 å®Œæˆåæ‰§è¡Œ,åŸºäºé¡¹ç›®ç”»åƒè¿›è¡Œé’ˆå¯¹æ€§åˆ†æ
> **æ—¶é•¿**: 15-20åˆ†é’Ÿ
> **ç›®æ ‡**: å¿«é€Ÿå»ºç«‹é¡¹ç›®å…¨å±€è®¤çŸ¥,è¯†åˆ«æ ¸å¿ƒæ¨¡å—å’Œä¼˜å…ˆçº§

---

## ğŸ¯ ç›®æ ‡

å¿«é€Ÿæ‰«æé¡¹ç›®ç»“æ„,å»ºç«‹å…¨å±€è®¤çŸ¥,è¯†åˆ«æ ¸å¿ƒæ¨¡å—å¹¶ç¡®å®šä¼˜å…ˆçº§,ä¸ºåç»­æ·±åº¦åˆ†ææä¾›æŒ‡å¯¼ã€‚

---

## ğŸ“‹ æ‰§è¡Œæ­¥éª¤

### Step 1.1: é¡¹ç›®å…ƒä¿¡æ¯æ”¶é›†

```markdown
ä»»åŠ¡æ¸…å•:
- [ ] è¯»å– package.json/pyproject.toml/go.mod è¯†åˆ«é¡¹ç›®ç±»å‹
- [ ] è¯»å– README.md ç†è§£é¡¹ç›®å®šä½
- [ ] æ£€æŸ¥ CHANGELOG.md äº†è§£æ¼”è¿›å†å²
- [ ] åˆ†æ .gitignore è¯†åˆ«æŠ€æœ¯æ ˆ
- [ ] ç»Ÿè®¡ä»£ç è§„æ¨¡ (æ–‡ä»¶æ•°ã€ä»£ç è¡Œæ•°ã€è´¡çŒ®è€…)
```

#### å®ç°æ–¹æ³•

```bash
# æ£€æµ‹é¡¹ç›®ç±»å‹
if [ -f "package.json" ]; then
  echo "Node.js/TypeScript é¡¹ç›®"
  npm_package_name=$(grep '"name"' package.json | head -1 | awk -F: '{ print $2 }' | sed 's/[",]//g' | tr -d '[:space:]')
  echo "é¡¹ç›®åç§°: $npm_package_name"
fi

if [ -f "pyproject.toml" ]; then
  echo "Python é¡¹ç›®"
fi

if [ -f "go.mod" ]; then
  echo "Go é¡¹ç›®"
fi

# ç»Ÿè®¡ä»£ç è§„æ¨¡
files_count=$(find src -name "*.ts" -o -name "*.js" -o -name "*.py" -o -name "*.go" | wc -l)
echo "æºç æ–‡ä»¶æ•°: $files_count"

# ç»Ÿè®¡è´¡çŒ®è€…
contributors=$(git shortlog -sn | wc -l)
echo "è´¡çŒ®è€…æ•°é‡: $contributors"
```

### Step 1.2: ç›®å½•ç»“æ„æ™ºèƒ½åˆ†æ

#### åˆ†ææŠ¥å‘Šæ ¼å¼

```typescript
// ç”Ÿæˆç»“æ„åˆ†ææŠ¥å‘Š
interface StructureAnalysisReport {
  é¡¹ç›®ç±»å‹: "CLIå·¥å…·" | "Webåº”ç”¨" | "åº“" | "æ¡†æ¶" | "ç§»åŠ¨åº”ç”¨" | "æ¡Œé¢åº”ç”¨";
  æŠ€æœ¯æ ˆ: string[];  // ["TypeScript", "React", "Node.js"]
  æ ¸å¿ƒç›®å½•: Record<string, string>; // {"src/": "æºç ä¸»ç›®å½•", "src/commands/": "å‘½ä»¤ç³»ç»Ÿ"}
  å¤æ‚åº¦è¯„åˆ†: {
    æ–‡ä»¶æ•°: number;
    ä»£ç è¡Œæ•°: number;
    ç›®å½•å±‚çº§: number;
    è¯„çº§: "ç®€å•" | "ä¸­ç­‰" | "å¤æ‚" | "éå¸¸å¤æ‚";
  };
}
```

#### ç›®å½•åˆ†æè„šæœ¬

```bash
# åˆ†æç›®å½•ç»“æ„
echo "## ç›®å½•ç»“æ„åˆ†æ"
find src -maxdepth 3 -type d | sort | while read dir; do
  file_count=$(find "$dir" -maxdepth 1 -name "*.ts" -o -name "*.js" -o -name "*.tsx" -o -name "*.jsx" | wc -l)
  if [ $file_count -gt 0 ]; then
    echo "- $dir/ ($file_count ä¸ªæ–‡ä»¶)"
  fi
done

# è¯†åˆ«æ ¸å¿ƒç›®å½•
core_dirs=("src/commands/" "src/components/" "src/services/" "src/utils/" "src/lib/")
for dir in "${core_dirs[@]}"; do
  if [ -d "$dir" ]; then
    echo "æ ¸å¿ƒç›®å½•: $dir"
  fi
done
```

### Step 1.3: æ ¸å¿ƒæ¨¡å—è¯†åˆ«

#### ä¼˜å…ˆçº§ç®—æ³•

åŸºäºä»¥ä¸‹è§„åˆ™è‡ªåŠ¨è¯†åˆ«æ ¸å¿ƒæ¨¡å—:

```markdown
ä¼˜å…ˆçº§è¯„åˆ† = å…¥å£æ–‡ä»¶æƒé‡Ã—3 + è¢«å¼•ç”¨æ¬¡æ•°Ã—2 + ä»£ç è¡Œæ•°Ã—1 + å…³é”®è¯åŒ¹é…

1. **å…¥å£æ–‡ä»¶æƒé‡ x3** (index.ts, main.ts, app.ts, App.tsx)
2. **è¢«å¼•ç”¨æ¬¡æ•°æƒé‡ x2** (importç»Ÿè®¡, ä½¿ç”¨ grep å‘½ä»¤)
3. **ä»£ç è¡Œæ•°æƒé‡ x1** (LOC > 300çš„æ–‡ä»¶)
4. **å…³é”®è¯åŒ¹é…** (å« core/engine/manager/controller/service/util)
5. **é…ç½®æ–‡ä»¶æŒ‡å‘** (tsconfig paths, webpack entry, package.json main)
```

#### å®ç°è„šæœ¬

```bash
# æ‰«ææ‰€æœ‰ TypeScript/JavaScript æ–‡ä»¶
find src -name "*.ts" -o -name "*.js" -o -name "*.tsx" -o -name "*.jsx" | while read file; do

  # è®¡ç®—æƒé‡
  weight=0

  # å…¥å£æ–‡ä»¶æ£€æµ‹
  if [[ "$file" == *"index.ts" || "$file" == *"main.ts" || "$file" == *"app.ts" || "$file" == *"App.tsx" ]]; then
    weight=$((weight + 3))
  fi

  # ä»£ç è¡Œæ•°æ£€æµ‹
  loc=$(wc -l < "$file")
  if [ $loc -gt 300 ]; then
    weight=$((weight + 1))
  fi

  # å…³é”®è¯åŒ¹é…
  if grep -q "core\|engine\|manager\|controller\|service\|util" "$file"; then
    weight=$((weight + 1))
  fi

  # è¢«å¼•ç”¨æ¬¡æ•°
  references=$(grep -r "import.*from.*$(basename "$file" .ts)" src/ | wc -l)
  weight=$((weight + references * 2))

  echo "$file: $weight (LOC: $loc, å¼•ç”¨: $references)"

done | sort -t: -k2 -nr | head -10
```

### Step 1.4: å¤æ‚åº¦è¯„ä¼°ä¸æ–‡æ¡£è§„åˆ’

#### å¤æ‚åº¦è¯„ä¼°è¡¨

```markdown
| æ¨¡å— | æ–‡ä»¶æ•° | LOC | å¼•ç”¨æ•° | å¤æ‚åº¦ | æ–‡æ¡£æ·±åº¦ |
|------|--------|-----|--------|--------|----------|
| src/loop.ts | 1 | 450 | 15 | â­â­â­â­â­ | æ·±åº¦è¯¦è§£ |
| src/context.ts | 1 | 280 | 32 | â­â­â­â­ | æ ¸å¿ƒæ¶æ„ |
| src/tools/ | 25 | 3200 | 8 | â­â­â­ | åˆ†ç±»æ¦‚è§ˆ |
| src/utils/ | 12 | 800 | 45 | â­â­â­â­ | æ ¸å¿ƒå·¥å…· |
| src/services/ | 8 | 1200 | 22 | â­â­â­â­ | æœåŠ¡è¯´æ˜ |
```

#### æ–‡æ¡£æ·±åº¦è§„åˆ’

æ ¹æ®å¤æ‚åº¦åˆ¶å®šæ–‡æ¡£æ·±åº¦:

- **å¤æ‚åº¦ â­â­â­â­â­** (5+ é¡µ): æ¶æ„å›¾ + æµç¨‹å›¾ + ä»£ç è§£æ + ç¤ºä¾‹ + æœ€ä½³å®è·µ
- **å¤æ‚åº¦ â­â­â­â­** (3-4 é¡µ): è®¾è®¡åŸç† + å…³é”®ä»£ç  + ä½¿ç”¨æ–¹å¼ + å¸¸è§é—®é¢˜
- **å¤æ‚åº¦ â­â­â­** (1-2 é¡µ): åŠŸèƒ½åˆ—è¡¨ + å…¸å‹ç¤ºä¾‹ + å¿«é€Ÿå‚è€ƒ
- **å¤æ‚åº¦ â­â­** (0.5-1 é¡µ): ç®€è¦è¯´æ˜ + åŸºæœ¬ç”¨æ³•

---

## ğŸ“Š è¾“å‡ºäº§ç‰©

```
wikirepo/
â”œâ”€â”€ 00-analysis-report.md          # ç»“æ„åˆ†ææŠ¥å‘Š
â”œâ”€â”€ 00-module-priority.md          # æ¨¡å—ä¼˜å…ˆçº§åˆ—è¡¨
â””â”€â”€ 00-documentation-plan.md       # æ–‡æ¡£ç”Ÿæˆè®¡åˆ’
```

### 1. ç»“æ„åˆ†ææŠ¥å‘Š (`00-analysis-report.md`)

```markdown
# é¡¹ç›®ç»“æ„åˆ†ææŠ¥å‘Š

> ç”Ÿæˆæ—¶é—´: 2025-10-24
> åˆ†æè€—æ—¶: 2.3 åˆ†é’Ÿ

## ğŸ“Š é¡¹ç›®æ¦‚è§ˆ

- **é¡¹ç›®ç±»å‹**: CLI å·¥å…·
- **æŠ€æœ¯æ ˆ**: TypeScript, Node.js, Ink
- **æ ¸å¿ƒç›®å½•**:
  - `src/commands/` - å‘½ä»¤ç³»ç»Ÿ (15 æ–‡ä»¶)
  - `src/tools/` - å·¥å…·ç³»ç»Ÿ (25 æ–‡ä»¶)
  - `src/utils/` - å·¥å…·å‡½æ•° (12 æ–‡ä»¶)

## ğŸ“ˆ å¤æ‚åº¦è¯„ä¼°

- **æ–‡ä»¶æ€»æ•°**: 150
- **ä»£ç è¡Œæ•°**: 15,000
- **ç›®å½•å±‚çº§**: 4
- **æ€»ä½“è¯„çº§**: ä¸­ç­‰å¤æ‚åº¦

## ğŸ¯ æ ¸å¿ƒæ¨¡å—è¯†åˆ«

åŸºäºä¼˜å…ˆçº§ç®—æ³•è¯†åˆ«å‡ºä»¥ä¸‹æ ¸å¿ƒæ¨¡å—:

1. `src/loop.ts` - AI å¾ªç¯å¼•æ“ (æƒé‡: 45)
2. `src/context.ts` - ä¸Šä¸‹æ–‡ç®¡ç† (æƒé‡: 38)
3. `src/project.ts` - é¡¹ç›®ç®¡ç† (æƒé‡: 32)
4. `src/tools/` - å·¥å…·ç³»ç»Ÿ (æƒé‡: 28)
...
```

### 2. æ¨¡å—ä¼˜å…ˆçº§åˆ—è¡¨ (`00-module-priority.md`)

```markdown
# æ¨¡å—ä¼˜å…ˆçº§åˆ—è¡¨

| æ’å | æ¨¡å— | æƒé‡ | LOC | å¼•ç”¨æ•° | å¤æ‚åº¦ | æ–‡æ¡£æ·±åº¦ |
|------|------|------|-----|--------|--------|----------|
| 1 | src/loop.ts | 45 | 450 | 15 | â­â­â­â­â­ | æ·±åº¦è¯¦è§£ |
| 2 | src/context.ts | 38 | 280 | 32 | â­â­â­â­ | æ ¸å¿ƒæ¶æ„ |
| 3 | src/project.ts | 32 | 320 | 18 | â­â­â­â­ | æ ¸å¿ƒæ¶æ„ |
| 4 | src/tools/ | 28 | 3200 | 8 | â­â­â­ | åˆ†ç±»æ¦‚è§ˆ |
| 5 | src/utils/ | 25 | 800 | 45 | â­â­â­â­ | æ ¸å¿ƒå·¥å…· |
```

### 3. æ–‡æ¡£ç”Ÿæˆè®¡åˆ’ (`00-documentation-plan.md`)

```markdown
# æ–‡æ¡£ç”Ÿæˆè®¡åˆ’

## ğŸ“… ç”Ÿæˆé¡ºåº

æŒ‰ä¼˜å…ˆçº§é¡ºåºç”Ÿæˆæ–‡æ¡£:

1. **ç¬¬1æ‰¹** (é«˜ä¼˜å…ˆçº§): Loop, Context, Project æ¨¡å—
2. **ç¬¬2æ‰¹** (ä¸­ä¼˜å…ˆçº§): Tools, Utils, Services
3. **ç¬¬3æ‰¹** (ä½ä¼˜å…ˆçº§): å…¶ä»–è¾…åŠ©æ¨¡å—

## ğŸ“ æ–‡æ¡£æ·±åº¦è§„åˆ’

### æ·±åº¦è¯¦è§£ (5+ é¡µ)
- `src/loop.ts` - AI å¾ªç¯å¼•æ“
  - æ¶æ„å›¾ + æµç¨‹å›¾
  - å®Œæ•´ä»£ç è§£æ
  - ä½¿ç”¨ç¤ºä¾‹
  - æ€§èƒ½ä¼˜åŒ–å»ºè®®

### æ ¸å¿ƒæ¶æ„ (3-4 é¡µ)
- `src/context.ts` - ä¸Šä¸‹æ–‡ç®¡ç†
- `src/project.ts` - é¡¹ç›®ç®¡ç†
  - è®¾è®¡åŸç†
  - å…³é”®ä»£ç 
  - ä½¿ç”¨æ–¹å¼

### åˆ†ç±»æ¦‚è§ˆ (1-2 é¡µ)
- `src/tools/` - å·¥å…·ç³»ç»Ÿ
  - åŠŸèƒ½åˆ—è¡¨
  - å…¸å‹ç¤ºä¾‹
  - å¿«é€Ÿå‚è€ƒ
```

---

## ğŸ”§ æŠ€æœ¯å®ç°

### ä¾èµ–åˆ†æå·¥å…·

```bash
# ä½¿ç”¨ madge ç”Ÿæˆä¾èµ–å›¾
npx madge --extensions ts,tsx,js,jsx --image dependency-graph.svg src/

# ä½¿ç”¨ dependency-cruiser åˆ†æä¾èµ–
npx dependency-cruiser --config .dependency-cruiser.json src/
```

### ä»£ç ç»Ÿè®¡å·¥å…·

```bash
# ä½¿ç”¨ cloc ç»Ÿè®¡ä»£ç 
cloc src/ --by-file --csv

# ä½¿ç”¨ wc ç»Ÿè®¡è¡Œæ•°
find src -name "*.ts" -o -name "*.js" | xargs wc -l
```

---

## ğŸ¯ ä¸é˜¶æ®µ0çš„é›†æˆ

é˜¶æ®µ1 åŸºäºé˜¶æ®µ0çš„é¡¹ç›®ç”»åƒè¿›è¡Œé’ˆå¯¹æ€§åˆ†æ:

- ä½¿ç”¨ `documentation_strategy` é€‰æ‹©åˆ†æé‡ç‚¹
- åŸºäº `architecture.pattern` è°ƒæ•´åˆ†ææ–¹æ³•
- å‚è€ƒ `business` ä¿¡æ¯å†³å®šåˆ†ææ·±åº¦
- åˆ©ç”¨ `knowledge_base` è¡¥å……åˆ†æç»´åº¦

**ç¤ºä¾‹**: å¯¹äº Next.js é¡¹ç›®,é‡ç‚¹å…³æ³¨:
- App Router ç»“æ„
- Server Components ä½¿ç”¨æƒ…å†µ
- API Routes ç«¯ç‚¹
- æ•°æ®è·å–æ¨¡å¼

---

## ğŸ“ˆ è´¨é‡æŒ‡æ ‡

- **åˆ†æå‡†ç¡®ç‡**: >95%
- **æ ¸å¿ƒæ¨¡å—è¦†ç›–ç‡**: 100%
- **å¤æ‚åº¦è¯„ä¼°è¯¯å·®**: <10%
- **æ‰§è¡Œæ—¶é—´**: <20 åˆ†é’Ÿ

---

**ä¸‹ä¸€é˜¶æ®µ**: [é˜¶æ®µ2: æ·±åº¦æ¨¡å—æŒ–æ˜](../03-phase2-deep-analysis.md)
