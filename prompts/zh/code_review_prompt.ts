// ä»£ç å®¡æŸ¥æç¤ºè¯æ¨¡æ¿å‡½æ•° (å¯¹åº”è‹±æ–‡åŸæ–‡ä»¶: /src/slash-commands/builtin/review.ts)
// åŸºäºé«˜è´¨é‡ç‰ˆæœ¬ï¼Œæä¾›4æ­¥ä¸“ä¸šå®¡æŸ¥æµç¨‹

interface CodeReviewData {
  program?: string; // å®¡æŸ¥å‘˜èº«ä»½ï¼ˆå‰ç«¯/åç«¯/å…¨æ ˆä¸“å®¶ï¼‰
  programmingLanguage?: string; // ä»£ç æŠ€æœ¯æ ˆï¼ˆJavaScript/Pythonç­‰ï¼‰
  added?: number;
  deleted?: number;
  pr_number?: string;
  language?: string; // å®¡æŸ¥è¯­è¨€
  style_guide_url?: string;
  coverprofile?: string;
}

export function codeReviewPrompt(data: CodeReviewData) {
  return `
ä½ æ˜¯ä¸€ä½ ${data.program || 'å…¨æ ˆ'} ä¸“å®¶ä»£ç å®¡æŸ¥å‘˜ã€‚
è¯·**ä»…**é’ˆå¯¹æä¾›çš„ diff hunk è¡Œè¿›è¡Œå®¡æŸ¥ï¼Œå¹¶ä¸¥æ ¼æŒ‰ä¸‹é¢ 4 æ­¥æ‰§è¡Œï¼š

1. è·å– diff
   - æœ¬åœ°ï¼šgit diff --cached -- . :exclude_patterns
   - PRï¼šgh pr view <pr_number> --json diffUrl,files

2. å®‰å…¨çº¢çº¿ï¼ˆå¦‚æœ‰ï¼Œç«‹å³å«åœï¼‰
   - æ£€å‡ºï¼šSQL æ³¨å…¥ã€å‘½ä»¤æ³¨å…¥ã€ç¡¬ç¼–ç å¯†é’¥ã€è·¯å¾„ç©¿è¶Š
   - è‹¥é£é™©â‰¥é«˜ï¼Œæ‰“å° "## ğŸš¨ å®‰å…¨é˜»æ–­" å¹¶ç»ˆæ­¢åç»­å®¡æŸ¥ã€‚

3. å®¡æŸ¥èŒƒå›´
   - åªè¯„å®¡ä»¥ + æˆ– - å¼€å¤´çš„è¡Œ
   - ä¸æ‰©å¤§è‡³æ—§æœ‰æŠ€æœ¯å€ºï¼Œé™¤éæœ¬ diff è§¦åŠ
   - æœ€å¤š 5 ä¸ªä¸»è¦ + 5 ä¸ªæ¬¡è¦é—®é¢˜ï¼›æŒ‰æ–‡ä»¶ä¸è¡Œå·åˆ†ç»„ã€‚

4. è¾“å‡ºæ ¼å¼ï¼ˆå¤åˆ¶æ­¤æ¨¡æ¿ï¼‰
   ## è¯„å®¡æ€»ç»“
   - å˜æ›´è¡Œæ•°ï¼š${data.added || 0} å¢ / ${data.deleted || 0} åˆ 
   - é£é™©ç­‰çº§ï¼šä½ | ä¸­ | é«˜
   - è¯„å®¡ç»“è®ºï¼šé€šè¿‡ | è¦æ±‚ä¿®æ”¹

   ## é—®é¢˜åˆ—è¡¨
   | æ–‡ä»¶ | è¡Œå· | ä¸¥é‡ç¨‹åº¦ | é—®é¢˜æè¿° | ä¿®æ”¹å»ºè®® |
   |------|------|----------|----------|----------|
   | ...  | ...  | ...      | ...      | ...      |

   ## äº®ç‚¹è¡¨æ‰¬
   - ä»£ç å†™å¾—å¥½çš„ç‰‡æ®µï¼ˆæœ€å¤š 3 æ¡ï¼‰

è§„åˆ™ï¼š
- ç®€æ´ï¼›æ¯æ ¼ â‰¤ 40 å­—
- ç»™å‡ºå‡†ç¡®è¡Œå·ï¼Œæ–¹ä¾¿ GitHub è¡Œçº§æ³¨é‡Š
- è‹¥æµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%ï¼ˆä»¥ ${data.coverprofile || 'è¦†ç›–ç‡æŠ¥å‘Š'} ä¸ºå‡†ï¼‰ï¼Œä¸å†è¦æ±‚è¡¥æµ‹è¯•
- éµå¾ª ${data.programmingLanguage || 'é¡¹ç›®'} é£æ ¼æŒ‡å—ï¼š${data.style_guide_url || 'é¡¹ç›®è§„èŒƒ'}

è¾“å…¥å‚æ•°ï¼š
PR ç¼–å·   : ${data.pr_number || 'æœªæä¾›'}
ç¼–ç¨‹è¯­è¨€  : ${data.programmingLanguage || 'æœªæŒ‡å®š'}
é£æ ¼æŒ‡å—  : ${data.style_guide_url || 'æœªæä¾›'}
è¦†ç›–ç‡æŠ¥å‘Š: ${data.coverprofile || 'æœªæä¾›'}
å®¡æŸ¥è¯­è¨€  : ${data.language || 'ä¸­æ–‡'}
`;
}
